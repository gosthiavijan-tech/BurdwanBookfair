<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>পুরস্কার আর্কাইভ - বর্ধমান অভিযান</title>
    <style>
        :root { --primary: #2c3e50; --blue: #3498db; }
        body { font-family: 'Segoe UI', Tahoma, Arial, sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); border-bottom: 3px solid var(--blue); padding-bottom: 10px; }
        
        .tabs { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin: 20px 0; }
        .tab-btn { padding: 10px 18px; border: 1px solid var(--blue); background: #fff; color: var(--blue); font-weight: bold; border-radius: 5px; cursor: pointer; transition: 0.3s; }
        .tab-btn.active { background: var(--blue); color: #fff; }

        .table-responsive { overflow-x: auto; margin-top: 20px; border: 1px solid #ddd; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th { background: #f8f9fa; color: #333; padding: 12px; text-align: left; border-bottom: 2px solid #ddd; }
        td { padding: 12px; border-bottom: 1px solid #eee; color: #444; }
        tr:hover { background: #f1f7ff; }

        .loading-box { text-align: center; padding: 50px; font-size: 18px; font-weight: bold; color: #666; }
        .error-box { padding: 25px; border: 1px dashed #e74c3c; background: #fdf2f2; color: #c0392b; text-align: center; border-radius: 8px; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1>সম্মাননা ও পুরস্কার আর্কাইভ</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="loadSheet('0', event)">দেবপ্রসন্ন পুরস্কার</button>
        <button class="tab-btn" onclick="loadSheet('1205965747', event)">শান্তি সাহা স্মৃতি</button>
        <button class="tab-btn" onclick="loadSheet('2125857118', event)">সমীরণ চৌধুরী স্মৃতি</button>
        <button class="tab-btn" onclick="loadSheet('1096819339', event)">অভিযান সাহিত্য সম্মান</button>
        <button class="tab-btn" onclick="loadSheet('807355523', event)">কৃষ্ণগোপাল কুণ্ডু স্মৃতি</button>
    </div>

    <div id="displayArea">
        <div id="loader" class="loading-box">ডেটা লোড হচ্ছে...</div>
        <div id="tableOutput" class="table-responsive" style="display:none;"></div>
    </div>
</div>

<script>
    // আপনার মূল পাবলিক লিঙ্ক
    const baseLink = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQeCT0dEBsTlRMIwuaItEYwAAZXdPQwPmTf4XJeYrc-Dk5DbVfogSQaIxPY6JWO6YUaSMi5cU0KM5p2/pub?output=csv";

    async function loadSheet(gid, e) {
        // UI আপডেট
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        if(e) e.target.classList.add('active');

        const loader = document.getElementById('loader');
        const output = document.getElementById('tableOutput');
        
        loader.style.display = 'block';
        loader.innerHTML = "গুগল থেকে ডেটা আনা হচ্ছে...";
        output.style.display = 'none';

        // GID যোগ করে নতুন লিঙ্ক তৈরি
        const finalUrl = `${baseLink}&gid=${gid}&single=true`;

        try {
            // Fetch API ব্যবহার করে ডেটা রিড করা
            const response = await fetch(finalUrl);
            if (!response.ok) throw new Error("Connection failed");
            
            const csvText = await response.text();
            renderTable(csvText);
            
            loader.style.display = 'none';
            output.style.display = 'block';
        } catch (err) {
            loader.innerHTML = `
                <div class="error-box">
                    <strong>ডেটা লোড করা যায়নি!</strong><br>
                    সম্ভবত আপনার ব্রাউজার ডেটা ব্লক করছে।<br>
                    <small>ফাইলটি ব্রাউজারের Incognito (প্রাইভেট) মোডে খুলে ট্রাই করুন অথবা অনলাইনে আপলোড করুন।</small>
                </div>`;
            console.error(err);
        }
    }

    function renderTable(csv) {
        const rows = csv.split('\n');
        if (rows.length === 0) return;

        let html = '<table><thead><tr>';
        
        // হেডার
        const headers = rows[0].split(',');
        headers.forEach(h => html += `<th>${h.replace(/"/g, '')}</th>`);
        html += '</tr></thead><tbody>';

        // ডেটা রো
        for (let i = 1; i < rows.length; i++) {
            const cols = rows[i].split(',');
            if (cols.length > 1) {
                html += '<tr>';
                cols.forEach(c => html += `<td>${c.replace(/"/g, '') || '-'}</td>`);
                html += '</tr>';
            }
        }
        html += '</tbody></table>';
        document.getElementById('tableOutput').innerHTML = html;
    }

    // প্রথমবার পেজ খুললে ট্যাব ১ লোড হবে
    window.onload = () => loadSheet('0');
</script>

</body>
</html>