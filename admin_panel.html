<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Admin Panel - BAG</title>
    <style>
        :root { --p: #6c5ce7; --s: #00b894; --d: #d63031; --bg: #f1f2f6; --dark: #2d3436; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 1450px; margin: auto; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Header */
        .header { background: var(--p); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .tabs { display: flex; background: #dfe6e9; padding: 5px 20px; gap: 10px; }
        .tab { padding: 12px 25px; cursor: pointer; border: none; font-weight: bold; background: transparent; transition: 0.3s; }
        .tab.active { background: white; color: var(--p); border-radius: 5px 5px 0 0; }

        /* Sections */
        .content-section { padding: 20px; display: none; }
        .content-section.active { display: block; }

        /* Dot Indicators */
        .dot { height: 10px; width: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .alive { background: var(--s); box-shadow: 0 0 8px var(--s); }
        .dead { background: var(--d); box-shadow: 0 0 8px var(--d); }

        /* Filter Box */
        .filter-row { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px; align-items: flex-end; }
        .filter-row div { flex: 1; min-width: 150px; }
        label { font-size: 12px; font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; }

        /* Member Table */
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: left; }
        th { background: var(--dark); color: white; }
        .badge { padding: 4px 8px; border-radius: 20px; font-size: 10px; font-weight: bold; background: #e1f5fe; color: #01579b; }

        /* Buttons */
        .btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        .btn-wa { background: #25D366; }
        .btn-del { background: var(--d); }
        .btn-edit { background: #0984e3; }
        
        #printModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; box-shadow: 0 0 100px rgba(0,0,0,0.3); border-radius: 10px; z-index: 1000; }

        @media print { 
            .no-print { display: none !important; } 
            .container { box-shadow: none; } 
            .p-hide { display: none !important; }
            table { width: 100% !important; border-collapse: collapse !important; }
            th, td { border: 1px solid #ccc !important; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div>
            <h2 style="margin:0;">ADMIN ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° - ‡ß®‡ß¶‡ß®‡ß¨</h2>
            <span style="font-size: 12px; opacity: 0.8;">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡¶¶ ‡¶ì ‡¶¨‡¶ï‡ßá‡ßü‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</span>
        </div>
        <button class="btn no-print" style="background:rgba(255,255,255,0.2)" onclick="logout()">üö™ ‡¶≤‡¶ó-‡¶Ü‡¶â‡¶ü</button>
    </div>

    <div class="tabs no-print">
        <button class="tab active" id="listTabBtn" onclick="showTab('list')">üìã ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</button>
        <button class="tab" id="entryTabBtn" onclick="showTab('entry')">‚ûï ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø / ‡¶è‡¶°‡¶ø‡¶ü</button>
    </div>

    <div id="listSection" class="content-section active">
        <div class="filter-row no-print">
            <div><label>‡¶®‡¶æ‡¶Æ/ID ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö</label><input type="text" id="sName" onkeyup="filter()"></div>
            <div><label>Alive/Dead</label>
                <select id="fAlive" onchange="filter()">
                    <option value="">‡¶∏‡¶¨</option>
                    <option value="Alive">Alive</option>
                    <option value="Dead">Dead</option>
                </select>
            </div>
            <div><label>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</label>
                <select id="fStatus" onchange="filter()">
                    <option value="">‡¶∏‡¶¨</option>
                    <option value="Active">Active</option>
                    <option value="Inactive">Inactive</option>
                </select>
            </div>
            <div><label>‡¶¨‡¶ï‡ßá‡ßü‡¶æ</label>
                <select id="fDue" onchange="filter()">
                    <option value="">‡¶∏‡¶¨</option>
                    <option value="0">‡¶¨‡¶ï‡ßá‡ßü‡¶æ ‡¶®‡ßá‡¶á</option>
                    <option value="1">‡¶¨‡¶ï‡ßá‡ßü‡¶æ ‡¶Ü‡¶õ‡ßá</option>
                </select>
            </div>
            <button class="btn btn-edit" onclick="document.getElementById('printModal').style.display='block'">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ö‡ßá‡¶ï-‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</button>
            <button class="btn btn-wa" onclick="sendWA()">üí¨ WhatsApp</button>
        </div>

        <div style="overflow-x: auto;">
            <table id="mainTable">
                <thead>
                    <tr>
                        <th class="no-print"><input type="checkbox" onclick="toggleAll(this)"></th>
                        <th>ID</th>
                        <th>‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶™‡¶¶‡¶¨‡ßÄ</th>
                        <th>‡¶¨‡¶ï‡ßá‡ßü‡¶æ</th>
                        <th>‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶§‡¶æ</th>
                        <th>Payment Status</th>
                        <th>Trx ID / Date</th>
                        <th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th>
                        <th class="no-print">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="entrySection" class="content-section">
        <div class="filter-row" style="background: #fff; border: 1px solid #eee;">
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:15px; width:100%;">
                <div><label>ID</label><input type="text" id="id" readonly></div>
                <div><label>Name</label><input type="text" id="name"></div>
                <div><label>Alive/Dead</label><select id="aliveDead"><option value="Alive">Alive</option><option value="Dead">Dead</option></select></div>
                <div><label>Phone</label><input type="text" id="phone"></div>
                <div><label>Designation</label><input type="text" id="designation"></div>
                <div><label>Joining Date</label><input type="date" id="joiningDate"></div>
                <div><label>Last Paid Year</label><input type="number" id="lastPaidYear" onchange="calcDue()"></div>
                <div><label>Due Years</label><input type="text" id="dueYears" readonly></div>
                <div><label>Status (Active/Inactive)</label><select id="status"><option value="Active">Active</option><option value="Inactive">Inactive</option></select></div>
                <div><label>Bill Book No</label><input type="text" id="billBookNo"></div>
                <div><label>Payment Status</label><select id="paymentStatus"><option value="Paid">Paid</option><option value="Pending">Pending</option></select></div>
                <div><label>tns id (Trx ID)</label><input type="text" id="trxId"></div>
                <div><label>Payment Date</label><input type="date" id="paymentDate"></div>
                <div><label>Payment Amount</label><input type="number" id="amount"></div>
                <div style="grid-column: span 2;"><label>Address</label><input type="text" id="address"></div>
            </div>
        </div>
        <button class="btn btn-wa" style="background:var(--s); padding:12px 30px;" id="saveBtn" onclick="save()">üíæ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button class="btn" style="background:gray; margin-left:10px;" onclick="resetForm()">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
    </div>
</div>

<div id="printModal" class="no-print">
    <h3>‡¶ï‡¶ø ‡¶ï‡¶ø ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶π‡¶¨‡ßá?</h3>
    <hr>
    <label><input type="checkbox" class="col-check" value="1" checked> ID ‡¶ï‡¶≤‡¶æ‡¶Æ</label><br>
    <label><input type="checkbox" class="col-check" value="2" checked> ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶™‡¶¶‡¶¨‡ßÄ</label><br>
    <label><input type="checkbox" class="col-check" value="3" checked> ‡¶¨‡¶ï‡ßá‡ßü‡¶æ</label><br>
    <label><input type="checkbox" class="col-check" value="4" checked> ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶§‡¶æ ‡¶∏‡¶Æ‡ßü‡¶ï‡¶æ‡¶≤</label><br>
    <label><input type="checkbox" class="col-check" value="5" checked> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</label><br>
    <label><input type="checkbox" class="col-check" value="6" checked> Trx ID / Date</label><br>
    <label><input type="checkbox" class="col-check" value="7" checked> ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</label><br>
    
    <div style="margin-top:15px;">
        <button class="btn btn-wa" onclick="doPrint()">‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü</button>
        <button class="btn btn-del" onclick="document.getElementById('printModal').style.display='none'">‡¶¨‡¶®‡ßç‡¶ß</button>
    </div>
</div>

<script>
    // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® Deploy ‡¶ï‡¶∞‡¶æ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü URL ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyEtw6soXGy_d7g7kyORHMHSX7m5MOnFOZ1DQKbRKQonMtPxE3gUWO9_3gUGVSAnF-ZSQ/exec';
    let members = [];
    let curYear = 2026;

    function logout() {
        if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶≤‡¶ó-‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
            window.location.replace("index.html");
        }
    }

    async function load() {
        try {
            const r = await fetch(scriptURL + '?type=all');
            const d = await r.json();
            members = d.members; 
            curYear = d.currentYear || 2026;
            document.getElementById('id').value = d.nextId;
            render(members);
        } catch (e) {
            console.error("Load failed", e);
        }
    }

    function render(data) {
        const b = document.getElementById('tableBody');
        b.innerHTML = data.map(m => {
            // ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶§‡¶æ‡¶∞ ‡¶¨‡¶õ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨
            let sinceYear = "N/A";
            if (m.joiningDate) {
                const jYear = new Date(m.joiningDate).getFullYear();
                if(!isNaN(jYear)) sinceYear = curYear - jYear;
            }

            return `
                <tr data-alive="${m.aliveDead}" data-status="${m.status}" data-due="${m.dueYears}">
                    <td class="no-print"><input type="checkbox" class="wa-check" data-phone="${m.phone}" data-name="${m.name}"></td>
                    <td>${m.id}</td>
                    <td>
                        <span class="dot ${m.aliveDead === 'Alive' ? 'alive' : 'dead'}"></span>
                        <b>${m.name}</b> <br> <small style="color:#666">${m.designation || ''}</small>
                    </td>
                    <td style="color:${m.dueYears > 0 ? 'red' : 'green'}"><b>${m.dueYears} ‡¶¨‡¶õ‡¶∞</b></td>
                    <td><span class="badge">${sinceYear} ‡¶¨‡¶õ‡¶∞ ‡¶ß‡¶∞‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§</span></td>
                    <td><b>${m.paymentStatus || 'N/A'}</b></td>
                    <td><small>${m.trxId || '-'}<br>${m.paymentDate ? new Date(m.paymentDate).toLocaleDateString('bn-BD') : '-'}</small></td>
                    <td>${m.status}</td>
                    <td class="no-print">
                        <button class="btn btn-edit" style="padding:4px 8px" onclick="edit('${m.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-del" style="padding:4px 8px" onclick="del('${m.id}')">üóëÔ∏è</button>
                    </td>
                </tr>
            `;
        }).join('');
    }

    function filter() {
        const n = document.getElementById('sName').value.toLowerCase();
        const a = document.getElementById('fAlive').value;
        const s = document.getElementById('fStatus').value;
        const d = document.getElementById('fDue').value;

        const f = members.filter(m => {
            return (m.name.toLowerCase().includes(n) || m.id.toString().includes(n)) &&
                   (a === "" || m.aliveDead === a) &&
                   (s === "" || m.status === s) &&
                   (d === "" || (d == "0" ? m.dueYears == 0 : m.dueYears > 0));
        });
        render(f);
    }

    function edit(id) {
        const m = members.find(i => i.id.toString() === id.toString());
        if(!m) return;
        
        // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ö‡¶ü‡ßã-‡¶´‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ
        document.getElementById('id').value = m.id;
        document.getElementById('name').value = m.name;
        document.getElementById('aliveDead').value = m.aliveDead;
        document.getElementById('phone').value = m.phone;
        document.getElementById('designation').value = m.designation;
        document.getElementById('address').value = m.address;
        
        if(m.joiningDate) document.getElementById('joiningDate').value = m.joiningDate.split('T')[0];
        
        document.getElementById('lastPaidYear').value = m.lastPaidYear;
        document.getElementById('dueYears').value = m.dueYears;
        document.getElementById('status').value = m.status;
        document.getElementById('billBookNo').value = m.billBookNo;
        document.getElementById('paymentStatus').value = m.paymentStatus || "Pending";
        document.getElementById('trxId').value = m.trxId;
        
        if(m.paymentDate) document.getElementById('paymentDate').value = m.paymentDate.split('T')[0];
        document.getElementById('amount').value = m.amount;

        document.getElementById('saveBtn').innerText = "üîÑ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®";
        document.getElementById('saveBtn').dataset.action = "edit";
        showTab('entry');
        window.scrollTo(0,0);
    }

    async function save() {
        const b = document.getElementById('saveBtn');
        const act = b.dataset.action || "add";
        const p = { action: act };
        
        // ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π
        document.querySelectorAll('#entrySection input, #entrySection select').forEach(i => p[i.id] = i.value);
        
        if(!p.name) return alert("‡¶®‡¶æ‡¶Æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá!");

        b.innerText = "‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç...";
        b.disabled = true;
        
        try {
            await fetch(scriptURL, { 
                method: 'POST', 
                body: JSON.stringify(p) 
            });
            alert("‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); 
            location.reload();
        } catch (e) {
            alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            b.disabled = false;
            b.innerText = "üíæ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®";
        }
    }

    async function del(id) {
        if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶è‡¶á ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡¶ï‡ßá ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
            await fetch(scriptURL, { 
                method: 'POST', 
                body: JSON.stringify({action: 'delete', id: id}) 
            });
            location.reload();
        }
    }

    function calcDue() {
        const y = parseInt(document.getElementById('lastPaidYear').value);
        if(!isNaN(y)) {
            document.getElementById('dueYears').value = Math.max(0, curYear - y);
        }
    }

    function showTab(t) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
        document.getElementById(t + 'Section').classList.add('active');
        document.getElementById(t + 'TabBtn').classList.add('active');
    }

    function sendWA() {
        const sel = document.querySelectorAll('.wa-check:checked');
        if(!sel.length) return alert("‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®");
        
        const msg = prompt("‡¶Æ‡ßá‡¶∏‡ßá‡¶ú‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®:");
        if(!msg) return;

        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶á‡¶Æ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®
        const fairLink = "https://www.burdwanbookfair.com"; 

        sel.forEach(c => {
            // ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶Ç
            let phone = c.dataset.phone.replace(/\D/g, ''); 
            if(phone.length === 10) {
                phone = '91' + phone;
            } else if(phone.length > 12 && phone.startsWith('91')) {
                phone = phone.slice(-12);
            }

            const name = c.dataset.name;
            // ‡¶è‡¶á ‡¶≤‡¶æ‡¶á‡¶®‡¶ü‡¶ø‡¶§‡ßá ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∞‡ßã ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
            const memberId = c.closest('tr').cells[1].innerText; 

            // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü: ‡¶®‡¶Æ‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ [‡¶®‡¶æ‡¶Æ] (ID: [‡¶Ü‡¶á‡¶°‡¶ø]), [‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú] [‡¶≤‡¶ø‡¶ô‡ßç‡¶ï]
            const finalMsg = "‡¶®‡¶Æ‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ " + name + " (ID: " + memberId + "),\n" + 
                             msg + "\n\n" + 
                             "‡¶¨‡¶á‡¶Æ‡ßá‡¶≤‡¶æ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü: " + fairLink;

            const encodedMsg = encodeURIComponent(finalMsg);
            
            const waLink = "https://api.whatsapp.com/send?phone=" + phone + "&text=" + encodedMsg;
            
            window.open(waLink, '_blank');
        });
    }

    function doPrint() {
    const table = document.getElementById('mainTable');
    const rows = table.rows;

    // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∏‡¶¨ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶•‡ßá‡¶ï‡ßá p-hide ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ (‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ)
    for (let i = 0; i < rows.length; i++) {
        for (let j = 0; j < rows[i].cells.length; j++) {
            rows[i].cells[j].classList.remove('p-hide');
        }
    }

    // ‡¶ö‡ßá‡¶ï‡¶¨‡¶ï‡ßç‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶π‡¶æ‡¶á‡¶° ‡¶ï‡¶∞‡¶æ
    const checkboxes = document.querySelectorAll('.col-check');
    checkboxes.forEach(cb => {
        if (!cb.checked) {
            const colIndex = parseInt(cb.value);
            for (let i = 0; i < rows.length; i++) {
                if (rows[i].cells[colIndex]) {
                    rows[i].cells[colIndex].classList.add('p-hide');
                }
            }
        }
    });

    // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶® ‡¶ï‡¶≤‡¶æ‡¶Æ (‡¶∂‡ßá‡¶∑ ‡¶ï‡¶≤‡¶æ‡¶Æ) ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶∏‡¶¨ ‡¶∏‡¶Æ‡ßü ‡¶π‡¶æ‡¶á‡¶° ‡¶•‡¶æ‡¶ï‡¶¨‡ßá
    for (let i = 0; i < rows.length; i++) {
        const lastCellIndex = rows[i].cells.length - 1;
        rows[i].cells[lastCellIndex].classList.add('p-hide');
    }

    document.getElementById('printModal').style.display = 'none';
    window.print();

    }

    function toggleAll(s) { 
        document.querySelectorAll('.wa-check').forEach(c => c.checked = s.checked); 
    }

    window.onload = load;
</script>
</body>
</html>