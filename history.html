<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ইতিহাস ও সম্পাদকীয় - বর্ধমান বইমেলা</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        body { background-color: #f0f2f5; color: #333; line-height: 1.8; }

        header {
            background: linear-gradient(rgba(26, 42, 108, 0.8), rgba(42, 72, 88, 0.8)), url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?auto=format&fit=crop&w=1350&q=80');
            background-size: cover; background-position: center;
            height: 200px; display: flex; justify-content: center; align-items: center;
            color: white; text-align: center; border-bottom: 5px solid #ffcc00;
        }

        .container { 
            max-width: 1100px; margin: -50px auto 60px; 
            background: white; padding: 40px; border-radius: 15px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
            position: relative;
        }

        .home-back-btn {
            display: inline-block; margin-bottom: 20px; padding: 8px 18px;
            background-color: #d63031; color: white; text-decoration: none;
            border-radius: 5px; font-weight: bold; font-size: 0.9rem; transition: 0.3s;
        }
        .home-back-btn:hover { background-color: #1a2a6c; transform: translateX(-5px); }

        .tab-menu { display: flex; justify-content: center; gap: 10px; margin-bottom: 40px; flex-wrap: wrap; }
        .tab-btn {
            padding: 10px 20px; background: #f8f9fa; border: 2px solid #1a2a6c;
            color: #1a2a6c; font-weight: bold; cursor: pointer; border-radius: 30px; transition: 0.3s;
            text-decoration: none; display: inline-block;
        }
        /* বাটন নীল হওয়ার স্টাইল */
        .tab-btn.active { background: #1a2a6c !important; color: white !important; }

        .content-section { display: none; animation: fadeIn 0.5s; }
        .content-section.active { display: block; }

        .filter-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px; background: #f1f3f8; padding: 20px; border-radius: 10px; }
        .table-scroll { max-height: 500px; overflow-y: auto; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; }
        thead th { position: sticky; top: 0; background-color: #1a2a6c; color: white; padding: 15px; text-align: left; z-index: 10; }
        td { padding: 12px; border: 1px solid #ddd; font-size: 0.9rem; }
        tr:nth-child(even) { background-color: #f9f9f9; }

        #loader { text-align: center; padding: 20px; font-weight: bold; color: #1a2a6c; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<header><h1>বর্ধমানের ঐতিহ্য ও ইতিহাস</h1></header>

<div class="container">
    <a href="index.html" class="home-back-btn">← হোম পেজে ফিরে যান</a>

    <div class="tab-menu">
        <a href="editorial_details.html" class="tab-btn" id="btn-editorial">সম্পাদকীয়</a>
        <a href="avijan_authors.html" class="tab-btn" id="btn-authors">অভিযান সাময়িকীর লেখক পরিচিতি</a>
        <button class="tab-btn active" onclick="showTab(event, 'history')" id="btn-history">স্থান, কাল ও উদ্বোধক</button>
        <a href="Organizational_Chart.html" class="tab-btn" id="btn-org">কার্যকারী সদস্য</a>
    </div>

    <div id="history" class="content-section active">
        <h2>স্থান, কাল ও উদ্বোধক</h2>
        <div class="filter-container">
            <select id="yearFilter" onchange="applyFilters()"><option value="">সব বছর</option></select>
            <select id="placeFilter" onchange="applyFilters()"><option value="">সব স্থান</option></select>
        </div>
        <div id="loader">ডাটা লোড হচ্ছে...</div>
        <div class="table-scroll">
            <table id="mainTable">
                <thead>
                    <tr>
                        <th>ক্রম (তম)</th>
                        <th>সন</th>
                        <th>তারিখ</th>
                        <th>স্থান</th>
                        <th>মঞ্চ</th>
                        <th>উদ্বোধক</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
async function fetchData() {
    const scriptUrl = 'https://script.google.com/macros/s/AKfycbxw0BixVV8OiG-U7QaEawfucnfieGj4brQ3RQpCKeCPy23mSvssaV3EbgwO7goWK2O7/exec';
    try {
        const response = await fetch(scriptUrl, { method: 'GET', mode: 'cors', redirect: 'follow' });
        const data = await response.json();
        displayTable(data);
    } catch (error) {
        document.getElementById('loader').innerText = 'ডাটা লোড করতে ব্যর্থ হয়েছে।';
    }
}

function displayTable(data) {
    const tbody = document.getElementById('tableBody');
    const yearFilter = document.getElementById('yearFilter');
    const placeFilter = document.getElementById('placeFilter');
    let years = new Set();
    let places = new Set();
    tbody.innerHTML = '';
    document.getElementById('loader').style.display = 'none';

    data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${row[0]||'-'}</td><td>${row[1]||'-'}</td><td>${row[2]||'-'}</td><td>${row[3]||'-'}</td><td>${row[4]||'-'}</td><td>${row[5]||'-'}</td>`;
        tbody.appendChild(tr);
        if(row[1]) years.add(row[1]);
        if(row[3]) places.add(row[3]);
    });
    [...years].sort().forEach(y => yearFilter.add(new Option(y, y)));
    [...places].sort().forEach(p => placeFilter.add(new Option(p, p)));
}

function applyFilters() {
    const y = document.getElementById('yearFilter').value;
    const p = document.getElementById('placeFilter').value;
    document.querySelectorAll('#tableBody tr').forEach(row => {
        const show = (!y || row.children[1].innerText === y) && (!p || row.children[3].innerText === p);
        row.style.display = show ? '' : 'none';
    });
}

// ট্যাব পরিবর্তন এবং বাটন হাইলাইট করার ফাংশন
function showTab(evt, id) {
    // সব কন্টেন্ট সেকশন লুকানো
    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
    // সব বাটন থেকে active ক্লাস সরানো
    document.querySelectorAll('.tab-menu .tab-btn').forEach(b => b.classList.remove('active'));
    
    // নির্দিষ্ট সেকশন দেখানো এবং বাটনে নীল রঙ দেওয়া
    document.getElementById(id).classList.add('active');
    evt.currentTarget.classList.add('active');
}

window.onload = fetchData;
</script>
</body>
</html>