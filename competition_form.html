<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø - ‡¶¨‡¶∞‡ßç‡¶ß‡¶Æ‡¶æ‡¶® ‡¶¨‡¶á‡¶Æ‡ßá‡¶≤‡¶æ</title>
    <style>
        /* ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { background-color: #f4f7f6; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .header-area { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #27ae60; padding-bottom: 15px; }
        h2 { color: #2c3e50; margin: 0; }
        .btn-logout { background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; color: #34495e; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; }
        .quiz-card { background: #f9f9f9; border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .btn-submit { background: #27ae60; color: white; border: none; padding: 15px; width: 100%; border-radius: 6px; font-size: 18px; cursor: pointer; font-weight: bold; transition: 0.3s; margin-bottom: 20px; }
        .status-tag { display: inline-block; background: #e8f5e9; color: #2e7d32; padding: 5px 10px; border-radius: 4px; font-weight: bold; margin-top: 5px; }
        .print-section { margin-top: 30px; padding-top: 20px; border-top: 2px solid #3498db; }
        .print-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 15px; }
        .btn-print { background: #3498db; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; transition: 0.3s; text-align: center; }
        .stats-container { margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; }
        .stat-box { background: #2c3e50; color: white; padding: 15px; border-radius: 6px; text-align: center; }
        .stat-count { font-size: 24px; font-weight: bold; color: #2ecc71; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-area">
        <h2>üèÜ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
        <button class="btn-logout" onclick="logout()">üö™ ‡¶≤‡¶ó-‡¶Ü‡¶â‡¶ü</button>
    </div>

    <div class="form-group">
        <label>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
        <select id="compCategory" onchange="renderForm()">
            <option value="">--‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®--</option>
            <option value="‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø">‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø</option>
            <option value="‡¶¨‡¶ø‡¶§‡¶∞‡ßç‡¶ï">‡¶¨‡¶ø‡¶§‡¶∞‡ßç‡¶ï</option>
            <option value="‡¶¨‡¶ï‡ßç‡¶§‡ßÉ‡¶§‡¶æ">‡¶¨‡¶ï‡ßç‡¶§‡ßÉ‡¶§‡¶æ</option>
            <option value="‡¶ï‡ßÅ‡¶á‡¶ú">‡¶ï‡ßÅ‡¶á‡¶ú</option>
            <option value="‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ">‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ</option>
            <option value="‡¶Ø‡ßá‡¶Æ‡¶® ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶∏‡¶æ‡¶ú‡ßã">‡¶Ø‡ßá‡¶Æ‡¶® ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶∏‡¶æ‡¶ú‡ßã</option>
            <option value="‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø ‡¶®‡¶æ‡¶ü‡¶ï">‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø ‡¶®‡¶æ‡¶ü‡¶ï</option>
        </select>
    </div>

    <form id="entryForm">
        <div id="dynamicFields"></div>
        <input type="hidden" name="calculated_sheet" id="hiddenSheet">
        <button type="button" id="submitBtn" class="btn-submit" onclick="submitData()" style="display: none;">‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶® (Submit)</button>
    </form>

    <div class="print-section">
        <h3 style="color: #2980b9;">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∂‡¶® (‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ):</h3>
        <div class="print-grid" id="printButtons"></div>
    </div>

    <h3 style="margin-top: 30px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">‡¶≤‡¶æ‡¶á‡¶≠ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏:</h3>
    <div class="stats-container" id="statsDisplay"></div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbygtBmRDGOhJn7DyczMw-g310oM3dgGDV4xz6EpmtNIMEE0Re_n2JCzAQFU0ollC4AZ/exec"; 
    
    // ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø ‡¶∂‡¶ø‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ
    const PRINT_SHEETS = [
        "‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶ï", "‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶ñ", "‡¶¨‡¶ø‡¶§‡¶∞‡ßç‡¶ï", "‡¶¨‡¶ï‡ßç‡¶§‡ßÉ‡¶§‡¶æ", "‡¶ï‡ßÅ‡¶á‡¶ú", 
        "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ï", "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ñ", "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ó", 
        "‡¶Ø‡ßá‡¶Æ‡¶® ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶∏‡¶æ‡¶ú‡ßã", "‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø ‡¶®‡¶æ‡¶ü‡¶ï"
    ];

    function logout() { if(confirm("‡¶≤‡¶ó-‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?")) window.location.href = "competitions.html"; }

    function createPrintButtons() {
        const container = document.getElementById('printButtons');
        container.innerHTML = "";
        PRINT_SHEETS.forEach(sheetName => {
            const btn = document.createElement('button');
            btn.className = 'btn-print';
            btn.innerHTML = `üñ®Ô∏è ${sheetName}`;
            btn.onclick = () => window.open(`${SCRIPT_URL}?action=print&category=${encodeURIComponent(sheetName)}`, '_blank');
            container.appendChild(btn);
        });
    }

    async function fetchLiveStats() {
        const container = document.getElementById('statsDisplay');
        try {
            const res = await fetch(SCRIPT_URL + "?action=getStats");
            const data = await res.json();
            container.innerHTML = "";
            PRINT_SHEETS.forEach(sh => {
                const count = data[sh] || 0;
                container.innerHTML += `<div class="stat-box"><strong>${sh}</strong><div class="stat-count">${count}</div></div>`;
            });
        } catch (e) { container.innerHTML = "<p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ...</p>"; }
    }

    function calcAge(dob) {
        if(!dob) return "";
        const birthDate = new Date(dob);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        if (today.getMonth() < birthDate.getMonth() || (today.getMonth() === birthDate.getMonth() && today.getDate() < birthDate.getDate())) age--;
        return age;
    }

    function renderForm() {
        const cat = document.getElementById('compCategory').value;
        const fields = document.getElementById('dynamicFields');
        const btn = document.getElementById('submitBtn');
        fields.innerHTML = "";
        btn.style.display = cat ? "block" : "none";
        if (!cat) return;

        let html = "";
        if (cat === '‡¶ï‡ßÅ‡¶á‡¶ú' || cat === '‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ') html += `<div class="form-group"><label>‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</label><input type="text" name="manual_form_no" required></div>`;
        html += `<div class="form-group"><label>‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</label><input type="tel" name="phone" required pattern="[0-9]{10}"></div>`;

        if (cat === '‡¶ï‡ßÅ‡¶á‡¶ú') {
            html += `<h4>‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø (‡ß®-‡ß© ‡¶ú‡¶®)</h4>`;
            for(let i=1; i<=3; i++) {
                html += `<div class="quiz-card"><label>‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ${i}:</label>
                <input type="text" name="m${i}_name" placeholder="‡¶®‡¶æ‡¶Æ" ${i<3?'required':''}>
                <input type="date" name="m${i}_dob" onchange="this.nextElementSibling.value = calcAge(this.value)" style="margin-top:5px">
                <input type="text" name="m${i}_age" placeholder="‡¶¨‡¶Ø‡¶º‡¶∏" readonly style="margin-top:5px; background:#eee">
                <input type="text" name="m${i}_school" placeholder="‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤" style="margin-top:5px">
                <select name="m${i}_class" style="margin-top:5px">${getClassList()}</select></div>`;
            }
        } else {
            html += `<div class="form-group"><label>‡¶®‡¶æ‡¶Æ:</label><input type="text" name="name" required></div>`;
            html += `<div class="form-group"><label>‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label><input type="date" name="dob" onchange="updateAgeAndSheet(this.value)" required></div>`;
            html += `<div class="form-group"><label>‡¶¨‡¶Ø‡¶º‡¶∏:</label><input type="text" name="age" id="dispAge" readonly style="background:#eee"> <div id="groupTag" class="status-tag"></div></div>`;
            if(['‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø', '‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ', '‡¶Ø‡ßá‡¶Æ‡¶® ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶∏‡¶æ‡¶ú‡ßã', '‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø ‡¶®‡¶æ‡¶ü‡¶ï'].includes(cat)) {
                html += `<div class="form-group"><label>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ:</label><select name="class">${getClassList()}</select></div>`;
                html += `<div class="form-group"><label>‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤:</label><input type="text" name="school"></div>`;
            }
            if(cat === '‡¶¨‡¶ø‡¶§‡¶∞‡ßç‡¶ï') html += `<div class="form-group"><label>‡¶™‡¶ï‡ßç‡¶∑/‡¶¨‡¶ø‡¶™‡¶ï‡ßç‡¶∑:</label><select name="side"><option>‡¶™‡¶ï‡ßç‡¶∑‡ßá</option><option>‡¶¨‡¶ø‡¶™‡¶ï‡ßç‡¶∑‡ßá</option></select></div>`;
        }
        fields.innerHTML = html;
        if(cat !== '‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø' && cat !== '‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ') document.getElementById('hiddenSheet').value = cat;
    }

    function getClassList() {
        let opt = `<option value="">‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®</option><option>KG</option>`;
        for(let i=1; i<=12; i++) opt += `<option>Class ${i}</option>`;
        return opt;
    }

    function updateAgeAndSheet(dob) {
    const age = calcAge(dob);
    const dispAge = document.getElementById('dispAge');
    const tag = document.getElementById('groupTag');
    const hiddenSheet = document.getElementById('hiddenSheet');
    const cat = document.getElementById('compCategory').value;
    
    if(dispAge) dispAge.value = age;
    let sheetName = "";
    let isValid = true;
    let errorMsg = "";

    if (cat === '‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø') {
        if (age <= 10) {
            sheetName = "‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶ï";
            tag.innerText = "‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó: ‡¶ï (‡ß¶-‡ßß‡ß¶ ‡¶¨‡¶õ‡¶∞)";
        } else if (age >= 11 && age <= 19) {
            sheetName = "‡¶Ü‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶ñ";
            tag.innerText = "‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó: ‡¶ñ (‡ßß‡ßß-‡ßß‡ßØ ‡¶¨‡¶õ‡¶∞)";
        } else {
            isValid = false;
            errorMsg = "‡¶¨‡ßü‡¶∏ ‡ßß‡ßß-‡ßß‡ßØ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá!";
        }
    } else if (cat === '‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ') {
        if (age < 7) {
            sheetName = "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ï";
            tag.innerText = "‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó: ‡¶ï";
        } else if (age < 13) {
            sheetName = "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ñ";
            tag.innerText = "‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó: ‡¶ñ";
        } else if (age >= 13 && age <= 19) {
            sheetName = "‡¶¨‡¶∏‡ßá ‡¶Ü‡¶Å‡¶ï‡¶æ ‡¶ó";
            tag.innerText = "‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó: ‡¶ó (‡ßß‡ß©-‡ßß‡ßØ ‡¶¨‡¶õ‡¶∞)";
        } else {
            isValid = false;
            errorMsg = "‡¶¨‡ßü‡¶∏ ‡ßß‡ßØ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡ßü!";
        }
    } else if (cat === '‡¶Ø‡ßá‡¶Æ‡¶® ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶∏‡¶æ‡¶ú‡ßã') {
        if (age <= 18) {
            sheetName = cat;
            tag.innerText = "‡¶¨‡ßü‡¶∏ ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá";
        } else {
            isValid = false;
            errorMsg = "‡ßß‡ßÆ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßü‡¶∏ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡ßü!";
        }
    } else {
        sheetName = cat;
        tag.innerText = "";
    }

    if (!isValid) {
        tag.innerText = errorMsg;
        tag.style.color = "red";
        hiddenSheet.value = "";
    } else {
        tag.style.color = "#2e7d32";
        hiddenSheet.value = sheetName;
    }
}

async function submitData() {
    const btn = document.getElementById('submitBtn');
    const cat = document.getElementById('compCategory').value;
    const sheetName = document.getElementById('hiddenSheet').value;

    // ‡¶ï‡ßÅ‡¶á‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶¨‡ßü‡¶∏ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ (‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶ï‡ßÅ‡¶á‡¶ú‡ßá‡¶∞ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá)
    if (cat === '‡¶ï‡ßÅ‡¶á‡¶ú') {
        const m1_age = calcAge(document.getElementsByName('m1_dob')[0].value);
        const m2_age = calcAge(document.getElementsByName('m2_dob')[0].value);
        const m3_age = document.getElementsByName('m3_dob')[0].value ? calcAge(document.getElementsByName('m3_dob')[0].value) : 0;

        if (m1_age > 18 || m2_age > 18 || m3_age > 18) {
            alert("‡¶ï‡ßÅ‡¶á‡¶ú ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ‡ßü ‡ßß‡ßÆ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßü‡¶∏ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡ßü!");
            return;
        }
        // ‡¶ï‡ßÅ‡¶á‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∂‡¶ø‡¶ü ‡¶®‡ßá‡¶Æ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
        document.getElementById('hiddenSheet').value = "‡¶ï‡ßÅ‡¶á‡¶ú";
    } else if (!sheetName) {
        alert("‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶¨‡ßü‡¶∏ ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶π‡¶ì‡ßü‡¶æ‡ßü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§");
        return;
    }

    if(!confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) return;

    btn.innerText = "‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
    btn.disabled = true;

    const formData = new URLSearchParams(new FormData(document.getElementById('entryForm')));
    formData.append("main_category", cat);
    formData.append("calculated_sheet", document.getElementById('hiddenSheet').value);

    try {
        const res = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
        const resultText = await res.text();
        if (!isNaN(resultText)) {
            alert("‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: " + resultText);
            location.reload();
        } else {
            alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: " + resultText);
            btn.disabled = false;
            btn.innerText = "Submit";
        }
    } catch (e) {
        alert("‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®!");
        btn.disabled = false;
        btn.innerText = "Submit";
    }
}

    window.onload = () => { fetchLiveStats(); createPrintButtons(); };
</script>
</body>
</html>